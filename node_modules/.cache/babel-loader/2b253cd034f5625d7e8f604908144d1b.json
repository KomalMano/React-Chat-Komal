{"ast":null,"code":"import _slicedToArray from\"D:/Softwares Working/All data/Web Develpment/Projects/4.Chat-app using React+firebase+scss/chatting-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import{useEffect}from'react';import{useState}from'react';import{doc,onSnapshot}from\"firebase/firestore\";import{useContext}from'react';import{AuthContext}from'../context/AuthContext';import{db}from'../firebase';import{ChatContext}from'../context/ChatContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Chats=function Chats(){var _Object$entries;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),chats=_useState2[0],setChats=_useState2[1];var _useContext=useContext(AuthContext),currentUser=_useContext.currentUser;var _useContext2=useContext(ChatContext),dispatch=_useContext2.dispatch;useEffect(function(){var getChats=function getChats(){var unsub=onSnapshot(doc(db,\"userChats\",currentUser.uid),function(doc){setChats(doc.data());});// clean up unsub\nreturn function(){unsub();};};currentUser.uid&&getChats();},[currentUser.uid]);console.log(chats);var handleSelect=function handleSelect(u){// we r now go on a update our user\ndispatch({type:\"CHANGE_USER\",payload:u});};return/*#__PURE__*/_jsx(\"div\",{className:\"chats\",children:(_Object$entries=Object.entries(chats))===null||_Object$entries===void 0?void 0:_Object$entries.sort(function(a,b){return b[1].date-a[1].date;}).map(function(chat){var _chat$1$lastMessage;return/*#__PURE__*/_jsxs(\"div\",{className:\"userChat\",onClick:function onClick(){return handleSelect(chat[1].userInfo);},children:[/*#__PURE__*/_jsx(\"img\",{src:chat[1].userInfo.photoURL,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"userChatInfo\",children:[/*#__PURE__*/_jsx(\"span\",{children:chat[1].userInfo.displayName}),/*#__PURE__*/_jsx(\"p\",{children:(_chat$1$lastMessage=chat[1].lastMessage)===null||_chat$1$lastMessage===void 0?void 0:_chat$1$lastMessage.text})]})]},chat[0]);})});};export default Chats;","map":{"version":3,"names":["React","useEffect","useState","doc","onSnapshot","useContext","AuthContext","db","ChatContext","Chats","chats","setChats","currentUser","dispatch","getChats","unsub","uid","data","console","log","handleSelect","u","type","payload","Object","entries","sort","a","b","date","map","chat","userInfo","photoURL","displayName","lastMessage","text"],"sources":["D:/Softwares Working/All data/Web Develpment/Projects/4.Chat-app using React+firebase+scss/chatting-app/src/components/Chats.jsx"],"sourcesContent":["import React from 'react'\r\nimport { useEffect } from 'react'\r\nimport { useState } from 'react'\r\nimport { doc, onSnapshot } from \"firebase/firestore\";\r\nimport { useContext } from 'react';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { db } from '../firebase';\r\nimport { ChatContext } from '../context/ChatContext';\r\n\r\nconst Chats = () => {\r\n\r\n  const [chats, setChats] = useState([])\r\n\r\n  const {currentUser} = useContext(AuthContext)\r\n  const {dispatch} = useContext(ChatContext)\r\n\r\n  useEffect(() => {\r\n    const getChats = () => {\r\n      const unsub = onSnapshot(doc(db, \"userChats\", currentUser.uid), (doc) => {\r\n        setChats(doc.data())\r\n      });\r\n    \r\n      // clean up unsub\r\n      return () => {\r\n        unsub();\r\n      };\r\n    };\r\n\r\n    currentUser.uid && getChats()\r\n  },[currentUser.uid])\r\n\r\n  console.log(chats)\r\n\r\n  const handleSelect = (u) => {\r\n    // we r now go on a update our user\r\n    dispatch({type:\"CHANGE_USER\", payload: u })\r\n  }\r\n\r\n  return (\r\n    <div className='chats'>\r\n      {Object.entries(chats)?.sort((a,b) => b[1].date - a[1].date).map((chat) => (\r\n      <div className='userChat' key={chat[0]} \r\n        onClick={() => handleSelect(chat[1].userInfo)}\r\n        \r\n        >\r\n        <img src={chat[1].userInfo.photoURL} alt='' />\r\n        <div className='userChatInfo'>\r\n            <span>{chat[1].userInfo.displayName}</span>\r\n            <p>{chat[1].lastMessage?.text}</p>\r\n        </div>\r\n      </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chats\r\n"],"mappings":"6LAAA,MAAOA,MAAP,KAAkB,OAAlB,CACA,OAASC,SAAT,KAA0B,OAA1B,CACA,OAASC,QAAT,KAAyB,OAAzB,CACA,OAASC,GAAT,CAAcC,UAAd,KAAgC,oBAAhC,CACA,OAASC,UAAT,KAA2B,OAA3B,CACA,OAASC,WAAT,KAA4B,wBAA5B,CACA,OAASC,EAAT,KAAmB,aAAnB,CACA,OAASC,WAAT,KAA4B,wBAA5B,C,wFAEA,GAAMC,MAAK,CAAG,QAARA,MAAQ,EAAM,qBAElB,cAA0BP,QAAQ,CAAC,EAAD,CAAlC,wCAAOQ,KAAP,eAAcC,QAAd,eAEA,gBAAsBN,UAAU,CAACC,WAAD,CAAhC,CAAOM,WAAP,aAAOA,WAAP,CACA,iBAAmBP,UAAU,CAACG,WAAD,CAA7B,CAAOK,QAAP,cAAOA,QAAP,CAEAZ,SAAS,CAAC,UAAM,CACd,GAAMa,SAAQ,CAAG,QAAXA,SAAW,EAAM,CACrB,GAAMC,MAAK,CAAGX,UAAU,CAACD,GAAG,CAACI,EAAD,CAAK,WAAL,CAAkBK,WAAW,CAACI,GAA9B,CAAJ,CAAwC,SAACb,GAAD,CAAS,CACvEQ,QAAQ,CAACR,GAAG,CAACc,IAAJ,EAAD,CAAR,CACD,CAFuB,CAAxB,CAIA;AACA,MAAO,WAAM,CACXF,KAAK,GACN,CAFD,CAGD,CATD,CAWAH,WAAW,CAACI,GAAZ,EAAmBF,QAAQ,EAA3B,CACD,CAbQ,CAaP,CAACF,WAAW,CAACI,GAAb,CAbO,CAAT,CAeAE,OAAO,CAACC,GAAR,CAAYT,KAAZ,EAEA,GAAMU,aAAY,CAAG,QAAfA,aAAe,CAACC,CAAD,CAAO,CAC1B;AACAR,QAAQ,CAAC,CAACS,IAAI,CAAC,aAAN,CAAqBC,OAAO,CAAEF,CAA9B,CAAD,CAAR,CACD,CAHD,CAKA,mBACE,YAAK,SAAS,CAAC,OAAf,2BACGG,MAAM,CAACC,OAAP,CAAef,KAAf,CADH,0CACG,gBAAuBgB,IAAvB,CAA4B,SAACC,CAAD,CAAGC,CAAH,QAASA,EAAC,CAAC,CAAD,CAAD,CAAKC,IAAL,CAAYF,CAAC,CAAC,CAAD,CAAD,CAAKE,IAA1B,EAA5B,EAA4DC,GAA5D,CAAgE,SAACC,IAAD,6CACjE,aAAK,SAAS,CAAC,UAAf,CACE,OAAO,CAAE,yBAAMX,aAAY,CAACW,IAAI,CAAC,CAAD,CAAJ,CAAQC,QAAT,CAAlB,EADX,wBAIE,YAAK,GAAG,CAAED,IAAI,CAAC,CAAD,CAAJ,CAAQC,QAAR,CAAiBC,QAA3B,CAAqC,GAAG,CAAC,EAAzC,EAJF,cAKE,aAAK,SAAS,CAAC,cAAf,wBACI,sBAAOF,IAAI,CAAC,CAAD,CAAJ,CAAQC,QAAR,CAAiBE,WAAxB,EADJ,cAEI,wCAAIH,IAAI,CAAC,CAAD,CAAJ,CAAQI,WAAZ,8CAAI,oBAAqBC,IAAzB,EAFJ,GALF,GAA+BL,IAAI,CAAC,CAAD,CAAnC,CADiE,EAAhE,CADH,EADF,CAgBD,CA7CD,CA+CA,cAAetB,MAAf"},"metadata":{},"sourceType":"module"}